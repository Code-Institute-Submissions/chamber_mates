{% extends "base.html" %}
{% load bootstrap_tags %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-xs-12">
                <h2>{{ group.name }}</h2>
                <h4>Members:</h4>
                <ul>
                    {% for instr in group.members.all %}
                        <li>
                            <a href="{% url 'user_profile' username=instr.user.username %}">
                                {{ instr.user.username }}
                            </a> 
                            - {{ instr.instrument.instrument }}
                        </li>
                    {% endfor %}
                </ul>
                {% if my_invites.all or other_invites.all %}
                    <h4>Users invited to join:</h4>
                    <ul>
                        {% for invite in my_invites.all %}
                            <li>
                                <a href="{% url 'user_profile' username=invite.invited_user.username %}">
                                    {{ invite.invited_user.username }}
                                </a>
                                to play {{ invite.invited_instrument.instrument }}
                                <form role="form" method="post" action="">
                                    {% csrf_token %}
                                    {{ mini_form | as_bootstrap_inline }}
                                    <button type="submit" class="btn btn-success btn-sm">Go!</button>
                                </form>
                            </li>                        
                        {% endfor %}
                        {% for invite in other_invites.all %}
                            <li>
                                <a href="{% url 'user_profile' username=invite.invited_user.username %}">
                                    {{ invite.invited_user.username }}
                                </a>
                                to play {{ invite.invited_instrument.instrument }}
                            </li>                        
                        {% endfor %}
                    </ul>
                {% endif %}
                {% if group.desired_instruments.all %}
                    <h4>Still looking for players of the following instruments:</h4>
                    {% if not member %}
                        <p>(If you would like to join, try sending a message to one of the existing members!)</p>
                    {% endif %}
                    <ul>
                        {% for desired in group.desired_instruments.all %}
                            <li>
                                {{ desired.instrument }}
                                {% if member %}
                                    <button class="btn btn-sm btn-success" onclick="location.href='{% url "specific_invite" group_id=group.pk instr_name=desired.instrument %}';">
                                        Invite someone!
                                    </button>
                                {% endif %}
                            </li>
                        {% endfor %}
                    </ul>
                {% endif %}
                <div id="dashboard-buttons">
                    <button class="btn btn-success" onclick="location.href='{% url "update" id=group.pk %}';">Edit group details</button>
                    <button class="btn btn-success" onclick="location.href='{% url "my_groups" %}';">All my groups</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
